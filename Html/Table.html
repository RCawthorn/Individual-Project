<!DOCTYPE html>
<html>
<Head>
    <link rel="stylesheet" type="text/css" href="TableStyle.css">
</head>
<body> 

<div class="bg">
<div class="dropdown">
    <font face="courier">
        <button onclick="myFunction()" class="dropbtn">Menu</button>
        <div id="myDropdown" class="dropdown-content">
            <a class="font" href="Front.html">Home</a>
            <a class="dropbtn" href="Booking.html">Bookings</a>
			<a class = "dropbtn" onclick="document.getElementById('id01').style.display='block'">Login</a>
			<a class = "dropbtn" href = "ContactUs.html">Contact us</a>
			<a class = "dropbtn" href = "Table.html">Table</a>
    </font>
</div>
</div>

    <script>
        /* When the user clicks on the button,
        toggle between hiding and showing the dropdown content */
        function myFunction() {
            document.getElementById("myDropdown").classList.toggle("show");
        }

        // Close the dropdown if the user clicks outside of it
        window.onclick = function (event) {
            if (!event.target.matches('.dropbtn')) {
                var dropdowns = document.getElementsByClassName("dropdown-content");
                var i;
                for (i = 0; i < dropdowns.length; i++) {
                    var openDropdown = dropdowns[i];
                    if (openDropdown.classList.contains('show')) {
                        openDropdown.classList.remove('show');
                    }
                }
            }
        }
    </script>
<table id="customers">
  <tr id="trow">
    <th>First name</th>
    <th>Last name</th>
    <th>Room number</th>
	<th>Time booked</th>
	<th></th>
  </tr>
</table>
<div class = "input">
<B>Please input details to book a time slot</B><BR>
First name: <input ="text" id = "first"><BR>
Second name: <input ="text" id = "last"><BR>
Room number: <input ="Text" id = "room"><BR>
Time booked: <input ="Text" id ="time"><BR>

<div class="container">
            <button type="button" onclick="userAdd()">Submit
            </button>
			</div>
			 </div>
			<script>	
	
let userAdd = function(){
        console.log("helloo");
        const Http = new XMLHttpRequest();
        const url='http://localhost:8080/Save';
        Http.open("POST", url);
        Http.setRequestHeader("Content-Type", "application/json");
        
        const fd = {
                "firstname":  document.getElementById('first').value,
                "lastname": document.getElementById('last').value,
                "room":  document.getElementById('room').value,
                "timeslot":  document.getElementById('time').value,

        };

        alert(fd.timeslot);
        Http.onload = function(){
            console.log("hello");
            console.log(Http.response);
			var tr=document.createElement("tr");
			var td1=document.createElement("td");
			var td2=document.createElement("td");
			var td3=document.createElement("td");
			var td4=document.createElement("td");
			var td5=document.createElement("td");
			var firstname=document.createElement("span");
			var lastname=document.createElement("span");
			let room=document.createElement("span");
			let timebooked=document.createElement("span");
			let deleteButton=document.createElement("button");
			deleteButton.id=fd.timeslot;
			deleteButton.type="button";
			deleteButton.onclick = function() {

           const Http = new XMLHttpRequest();
        const url='http://localhost:8080/Delete/' + this.id;
        Http.open("DELETE", url);
        Http.setRequestHeader("Content-Type", "application/json");
            Http.onreadystatechange = function(ev){
            }
            Http.send();
            location.reload();
        }
			firstname.innerHTML=fd.firstname;
			lastname.innerHTML=fd.lastname;
			room.innerHTML=fd.room;
			timebooked.innerHTML=fd.timeslot;

			
			td1.appendChild(firstname);
			td2.appendChild(lastname);
			td3.appendChild(room);
			td4.appendChild(timebooked);
			td5.appendChild(deleteButton);
			
			tr.appendChild(td1);
			tr.appendChild(td2);
			tr.appendChild(td3);
			tr.appendChild(td4);
			tr.appendChild(td5);
			
			document.getElementById("customers").appendChild(tr);

        }
            Http.send(JSON.stringify(fd))
        }
		
		
			
			</script>
			</head>
</body>
</html>